import json
import boto3

textract = boto3.client('textract')
s3 = boto3.client('s3')

def lambda_handler(event, context):
    body = json.loads(event['body'])
    
    bucket_name = body['bucketName']
    s3_key = body['s3Key']
    

    response = textract.detect_document_text(
        Document={
            'S3Object': {
                'Bucket': bucket_name,
                'Name': s3_key
            }
        }
    )
    
    
    extracted_text = ''
    for item in response['Blocks']:
        if item['BlockType'] == 'LINE':
            extracted_text += item['Text'] + '\n'
    
    return {
        'statusCode': 200,
        'body': json.dumps({
            'message': 'Text extracted successfully!',
            'extractedText': extracted_text,
            'totalBlocks': len(response['Blocks'])
        })
    }